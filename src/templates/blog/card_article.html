{% load static %}
{% load custom_tags %}

<!-- Custom CSS -->
{% block styles %}
<link rel="stylesheet" href="{% static 'css/blog/card_article.css' %}">
{% endblock styles %}

<!-- ÐšÐ°Ñ€Ñ‚Ð¾Ñ‡ÐºÐ° Ð¿Ð¾ÑÑ‚Ð° -->
<a href="{% url 'blog:article_detail' slug=article.slug %}" class="text-decoration-none">
<div class="article-card">
    <!-- ÐŸÐ¾Ð»Ð¾ÑÐ° ÑÐ»ÐµÐ²Ð° -->
    <div class="article-card__stripe"></div>

    <div class="article-card__content-wrapper">
        <!-- Ð”Ð°Ñ‚Ð° Ð¿ÑƒÐ±Ð»Ð¸ÐºÐ°Ñ†Ð¸Ð¸ -->
        <p class="article-card__publish-date">{{ article.published|date:"d.m.Y" }}</p>

        <!-- Ð—Ð°Ð³Ð¾Ð»Ð¾Ð²Ð¾Ðº ÑÑ‚Ð°Ñ‚ÑŒÐ¸ -->
        <h2 class="article-card__title">

                {{ article.title }}

        </h2>

        <!-- Ð¡Ð¾Ð´ÐµÑ€Ð¶Ð°Ð½Ð¸Ðµ ÑÑ‚Ð°Ñ‚ÑŒÐ¸ -->
        <p class="article-card__text">
            {{ article.content_html|safe }}
        </p>

        <!-- Ð¢ÐµÐ³Ð¸ ÑÑ‚Ð°Ñ‚ÑŒÐ¸ -->
        <div class="article-card__tags">
            {% for tag_relation in article.articletag_set.all %}
                {% with rgb=tag_relation.tag.color|hex_to_rgb %}
                    <span class="article-card__tag" style="background-color: rgba({{ rgb.0 }}, {{ rgb.1 }}, {{ rgb.2 }}, 0.15); color: {{ tag_relation.tag.color }};">
                        {{ tag_relation.tag.tag_name }}
                    </span>
                {% endwith %}

            {% endfor %}
        </div>
    </div>

    <!-- Ð¤ÑƒÑ‚ÐµÑ€ ÐºÐ°Ñ€Ñ‚Ð¾Ñ‡ÐºÐ¸ Ñ Ð¸Ð½Ñ„Ð¾Ñ€Ð¼Ð°Ñ†Ð¸ÐµÐ¹ Ð¾Ð± Ð°Ð²Ñ‚Ð¾Ñ€Ðµ Ð¸ ÑÑ‚Ð°Ñ‚Ð¸ÑÑ‚Ð¸ÐºÐ¾Ð¹ -->
    <div class="article-card__footer">
        <!-- Ð˜Ð½Ñ„Ð¾Ñ€Ð¼Ð°Ñ†Ð¸Ñ Ð¾Ð± Ð°Ð²Ñ‚Ð¾Ñ€Ðµ -->
        <div class="article-card__author">
            {% if article.author.avatar %}
                <img src="{{ article.author.avatar.url }}" alt="{{ article.author.first_name }}" class="article-card__author-avatar">
            {% else %}
                <img src="{% static 'img/user.png' %}" alt="Default Avatar" class="article-card__author-avatar">
            {% endif %}
            <span class="article-card__author-name">{{ article.author.first_name }}</span>
        </div>

        <!-- Ð¡Ñ‚Ð°Ñ‚Ð¸ÑÑ‚Ð¸ÐºÐ° -->
        <div class="article-card__stats">
            <span class="article-card__comments">ðŸ’¬ {{ article.comment.all.count }}</span>
            <span class="article-card__views">
                <img src="{% static 'img/eye.png' %}" class="article-card__eye">
                {{ article.views }}
            </span>
        </div>
    </div>

    <!-- Ð˜ÐºÐ¾Ð½ÐºÐ° Ñ‚ÐµÐ³Ð° -->
    {% with first_tag=article.articletag_set.first %}
    {% if first_tag and first_tag.tag.icon %} <!-- ÐŸÑ€Ð¾Ð²ÐµÑ€ÑÐµÐ¼ Ð½Ð°Ð»Ð¸Ñ‡Ð¸Ðµ Ð¸ÐºÐ¾Ð½ÐºÐ¸ Ñƒ Ð¿ÐµÑ€Ð²Ð¾Ð³Ð¾ Ñ‚ÐµÐ³Ð° -->
        <div class="article-card__tag-icon">
            <img src="{{ first_tag.tag.icon.url }}" alt="Tag Icon">
        </div>
    {% endif %}
    {% endwith %}
</div>
</a>